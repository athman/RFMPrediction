<script src="//maps.google.com/maps/api/js?v=3.13&amp;sensor=false&amp;libraries=geometry" type="text/javascript"></script>
<script src='//google-maps-utility-library-v3.googlecode.com/svn/tags/markerclustererplus/2.0.14/src/markerclusterer_packed.js' type='text/javascript'></script>

<div style='width: auto;'>
	<div id="map" style='width: 800px; height: 400px;'></div>
</div>

<script>
	handler = Gmaps.build('Google');
	handler.buildMap({ provider: {}, internal: {id: 'map'}}, function(){
		markers = handler.addMarkers(<%= raw @markers.to_json %>);
		//markers = handler.addMarkers([{"lat":"-1.52192","lng":"37.26639","title":"A meter","picture":{"url":"https://addons.cdn.mozilla.net/img/uploads/addon_icons/13/13028-64.png","width":36,"height":36},"infowindow":"A meter description"},{"lat":"-1.515824","lng":"37.269289","title":"A meter","picture":{"url":"https://addons.cdn.mozilla.net/img/uploads/addon_icons/13/13028-64.png","width":36,"height":36},"infowindow":"A meter description"},{"lat":"-1.514339","lng":"37.267083","title":"A meter","picture":{"url":"https://addons.cdn.mozilla.net/img/uploads/addon_icons/13/13028-64.png","width":36,"height":36},"infowindow":"A meter description"},{"lat":"-1.518244","lng":"37.26303","title":"A meter","picture":{"url":"https://addons.cdn.mozilla.net/img/uploads/addon_icons/13/13028-64.png","width":36,"height":36},"infowindow":"A meter description"},{"lat":"-1.52131","lng":"37.268784","title":"A meter","picture":{"url":"https://addons.cdn.mozilla.net/img/uploads/addon_icons/13/13028-64.png","width":36,"height":36},"infowindow":"A meter description"},{"lat":"-1.514908","lng":"37.263878","title":"A meter","picture":{"url":"https://addons.cdn.mozilla.net/img/uploads/addon_icons/13/13028-64.png","width":36,"height":36},"infowindow":"A meter description"},{"lat":"-1.513436","lng":"37.263173","title":"A meter","picture":{"url":"https://addons.cdn.mozilla.net/img/uploads/addon_icons/13/13028-64.png","width":36,"height":36},"infowindow":"A meter description"},{"lat":"-1.514184","lng":"37.266435","title":"A meter","picture":{"url":"https://addons.cdn.mozilla.net/img/uploads/addon_icons/13/13028-64.png","width":36,"height":36},"infowindow":"A meter description"},{"lat":"-1.517086","lng":"37.270076","title":"A meter","picture":{"url":"https://addons.cdn.mozilla.net/img/uploads/addon_icons/13/13028-64.png","width":36,"height":36},"infowindow":"A meter description"},{"lat":"-1.519211","lng":"37.263824","title":"A meter","picture":{"url":"https://addons.cdn.mozilla.net/img/uploads/addon_icons/13/13028-64.png","width":36,"height":36},"infowindow":"A meter description"},{"lat":"-1.522312","lng":"37.26888","title":"A meter","picture":{"url":"https://addons.cdn.mozilla.net/img/uploads/addon_icons/13/13028-64.png","width":36,"height":36},"infowindow":"A meter description"},{"lat":"-1.518343","lng":"37.269847","title":"A meter","picture":{"url":"https://addons.cdn.mozilla.net/img/uploads/addon_icons/13/13028-64.png","width":36,"height":36},"infowindow":"A meter description"},{"lat":"-1.515985","lng":"37.270761","title":"A meter","picture":{"url":"https://addons.cdn.mozilla.net/img/uploads/addon_icons/13/13028-64.png","width":36,"height":36},"infowindow":"A meter description"},{"lat":"-1.520027","lng":"37.271845","title":"A meter","picture":{"url":"https://addons.cdn.mozilla.net/img/uploads/addon_icons/13/13028-64.png","width":36,"height":36},"infowindow":"A meter description"},{"lat":"-1.514986","lng":"37.264961","title":"A meter","picture":{"url":"https://addons.cdn.mozilla.net/img/uploads/addon_icons/13/13028-64.png","width":36,"height":36},"infowindow":"A meter description"},{"lat":"-1.513407","lng":"37.264547","title":"A meter","picture":{"url":"https://addons.cdn.mozilla.net/img/uploads/addon_icons/13/13028-64.png","width":36,"height":36},"infowindow":"A meter description"},{"lat":"-1.518228","lng":"37.270021","title":"A meter","picture":{"url":"https://addons.cdn.mozilla.net/img/uploads/addon_icons/13/13028-64.png","width":36,"height":36},"infowindow":"A meter description"},{"lat":"-1.513751","lng":"37.269435","title":"A meter","picture":{"url":"https://addons.cdn.mozilla.net/img/uploads/addon_icons/13/13028-64.png","width":36,"height":36},"infowindow":"A meter description"},{"lat":"-1.512769","lng":"37.269338","title":"A meter","picture":{"url":"https://addons.cdn.mozilla.net/img/uploads/addon_icons/13/13028-64.png","width":36,"height":36},"infowindow":"A meter description"},{"lat":"-1.516388","lng":"37.27197","title":"A meter","picture":{"url":"https://addons.cdn.mozilla.net/img/uploads/addon_icons/13/13028-64.png","width":36,"height":36},"infowindow":"A meter description"},{"lat":"-1.515388","lng":"37.27029","title":"A meter","picture":{"url":"https://addons.cdn.mozilla.net/img/uploads/addon_icons/13/13028-64.png","width":36,"height":36},"infowindow":"A meter description"},{"lat":"-1.516866","lng":"37.270042","title":"A meter","picture":{"url":"https://addons.cdn.mozilla.net/img/uploads/addon_icons/13/13028-64.png","width":36,"height":36},"infowindow":"A meter description"},{"lat":"-1.516266","lng":"37.264452","title":"A meter","picture":{"url":"https://addons.cdn.mozilla.net/img/uploads/addon_icons/13/13028-64.png","width":36,"height":36},"infowindow":"A meter description"},{"lat":"-1.522421","lng":"37.26651","title":"A meter","picture":{"url":"https://addons.cdn.mozilla.net/img/uploads/addon_icons/13/13028-64.png","width":36,"height":36},"infowindow":"A meter description"},{"lat":"-1.516477","lng":"37.263147","title":"A meter","picture":{"url":"https://addons.cdn.mozilla.net/img/uploads/addon_icons/13/13028-64.png","width":36,"height":36},"infowindow":"A meter description"},{"lat":"-1.519916","lng":"37.263384","title":"A meter","picture":{"url":"https://addons.cdn.mozilla.net/img/uploads/addon_icons/13/13028-64.png","width":36,"height":36},"infowindow":"A meter description"},{"lat":"-1.520035","lng":"37.263308","title":"A meter","picture":{"url":"https://addons.cdn.mozilla.net/img/uploads/addon_icons/13/13028-64.png","width":36,"height":36},"infowindow":"A meter description"},{"lat":"-1.516586","lng":"37.266479","title":"A meter","picture":{"url":"https://addons.cdn.mozilla.net/img/uploads/addon_icons/13/13028-64.png","width":36,"height":36},"infowindow":"A meter description"},{"lat":"-1.518434","lng":"37.263997","title":"A meter","picture":{"url":"https://addons.cdn.mozilla.net/img/uploads/addon_icons/13/13028-64.png","width":36,"height":36},"infowindow":"A meter description"},{"lat":"-1.516649","lng":"37.265422","title":"A meter","picture":{"url":"https://addons.cdn.mozilla.net/img/uploads/addon_icons/13/13028-64.png","width":36,"height":36},"infowindow":"A meter description"},{"lat":"-1.515045","lng":"37.267241","title":"A meter","picture":{"url":"https://addons.cdn.mozilla.net/img/uploads/addon_icons/13/13028-64.png","width":36,"height":36},"infowindow":"A meter description"},{"lat":"-1.51969","lng":"37.26921","title":"A meter","picture":{"url":"https://addons.cdn.mozilla.net/img/uploads/addon_icons/13/13028-64.png","width":36,"height":36},"infowindow":"A meter description"},{"lat":"-1.516681","lng":"37.269585","title":"A meter","picture":{"url":"https://addons.cdn.mozilla.net/img/uploads/addon_icons/13/13028-64.png","width":36,"height":36},"infowindow":"A meter description"},{"lat":"-1.519523","lng":"37.263225","title":"A meter","picture":{"url":"https://addons.cdn.mozilla.net/img/uploads/addon_icons/13/13028-64.png","width":36,"height":36},"infowindow":"A meter description"},{"lat":"-1.517343","lng":"37.263078","title":"A meter","picture":{"url":"https://addons.cdn.mozilla.net/img/uploads/addon_icons/13/13028-64.png","width":36,"height":36},"infowindow":"A meter description"},{"lat":"-1.514488","lng":"37.264972","title":"A meter","picture":{"url":"https://addons.cdn.mozilla.net/img/uploads/addon_icons/13/13028-64.png","width":36,"height":36},"infowindow":"A meter description"},{"lat":"-1.513561","lng":"37.269611","title":"A meter","picture":{"url":"https://addons.cdn.mozilla.net/img/uploads/addon_icons/13/13028-64.png","width":36,"height":36},"infowindow":"A meter description"},{"lat":"-1.516387","lng":"37.265661","title":"A meter","picture":{"url":"https://addons.cdn.mozilla.net/img/uploads/addon_icons/13/13028-64.png","width":36,"height":36},"infowindow":"A meter description"},{"lat":"-1.521792","lng":"37.263072","title":"A meter","picture":{"url":"https://addons.cdn.mozilla.net/img/uploads/addon_icons/13/13028-64.png","width":36,"height":36},"infowindow":"A meter description"},{"lat":"-1.517219","lng":"37.263701","title":"A meter","picture":{"url":"https://addons.cdn.mozilla.net/img/uploads/addon_icons/13/13028-64.png","width":36,"height":36},"infowindow":"A meter description"},{"lat":"-1.514737","lng":"37.265454","title":"A meter","picture":{"url":"https://addons.cdn.mozilla.net/img/uploads/addon_icons/13/13028-64.png","width":36,"height":36},"infowindow":"A meter description"},{"lat":"-1.513764","lng":"37.269632","title":"A meter","picture":{"url":"https://addons.cdn.mozilla.net/img/uploads/addon_icons/13/13028-64.png","width":36,"height":36},"infowindow":"A meter description"},{"lat":"-1.522534","lng":"37.271807","title":"A meter","picture":{"url":"https://addons.cdn.mozilla.net/img/uploads/addon_icons/13/13028-64.png","width":36,"height":36},"infowindow":"A meter description"},{"lat":"-1.515254","lng":"37.266714","title":"A meter","picture":{"url":"https://addons.cdn.mozilla.net/img/uploads/addon_icons/13/13028-64.png","width":36,"height":36},"infowindow":"A meter description"},{"lat":"-1.514577","lng":"37.270643","title":"A meter","picture":{"url":"https://addons.cdn.mozilla.net/img/uploads/addon_icons/13/13028-64.png","width":36,"height":36},"infowindow":"A meter description"},{"lat":"-1.521562","lng":"37.263455","title":"A meter","picture":{"url":"https://addons.cdn.mozilla.net/img/uploads/addon_icons/13/13028-64.png","width":36,"height":36},"infowindow":"A meter description"},{"lat":"-1.515717","lng":"37.266509","title":"A meter","picture":{"url":"https://addons.cdn.mozilla.net/img/uploads/addon_icons/13/13028-64.png","width":36,"height":36},"infowindow":"A meter description"},{"lat":"-1.51397","lng":"37.269768","title":"A meter","picture":{"url":"https://addons.cdn.mozilla.net/img/uploads/addon_icons/13/13028-64.png","width":36,"height":36},"infowindow":"A meter description"},{"lat":"-1.515303","lng":"37.263747","title":"A meter","picture":{"url":"https://addons.cdn.mozilla.net/img/uploads/addon_icons/13/13028-64.png","width":36,"height":36},"infowindow":"A meter description"},{"lat":"-1.51574","lng":"37.272201","title":"A meter","picture":{"url":"https://addons.cdn.mozilla.net/img/uploads/addon_icons/13/13028-64.png","width":36,"height":36},"infowindow":"A meter description"}]);
		handler.bounds.extendWith(markers);
		handler.fitMapToBounds();
	});
</script>
